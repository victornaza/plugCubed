/*
 Copyright (c) 2012-2013 by Jeremy "Colgate" Richardson and Thomas "TAT" Andresen

 Permission to use and/or distribute this software or parts of it for any purpose without
 fee is hereby granted, provided that the above copyright notice and this permission notice
 appear in all copies.

 Permission to copy and/or edit this software or parts of it for any purpose is NOT permitted
 without written permission by the authors.

 THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHORS DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE
 INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHORS
 BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER
 RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
 OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

 @author  Jeremy "Colgate" Richardson
 @author  Thomas "TAT" Andresen
*/
var d=void 0,e=!0,f=null,h=!1;function k(){}k.prototype=Error();k.prototype.name="NotImplementedError";"undefined"!==typeof plugCubed&&plugCubed.close();Math.Na=function(){return 1+Math.floor(10*Math.random())};
console.info=function(a){console.log(a);m!==d?(log('<span style="color:#FF0000">'+plugCubed.d("disconnected",[plugCubed.O()])+" "+plugCubed.d("reloading")+"</span>"),setTimeout(function(){location.reload(e)},3E3)):n||(n=e,log('<span style="color:#FF0000">'+plugCubed.d("disconnected",[plugCubed.O()])+"</span>"))};
var m,n=h,p=Class.extend({D:{},version:{major:1,minor:7,patch:0,oa:"alpha.3",toString:function(){return this.major+"."+this.minor+"."+this.patch+(this.oa!==d?"-"+this.oa:"")}},init:function(){this.proxy={menu:$.proxy(this.onMenuClick,this),S:$.proxy(this.S,this),onVoteUpdate:$.proxy(this.onVoteUpdate,this),R:$.proxy(this.R,this),T:$.proxy(this.T,this),U:$.proxy(this.U,this),Q:$.proxy(this.Q,this),k:$.proxy(this.k,this),u:$.proxy(this.u,this)};localStorage.Y!==d&&($.getScript("https://rawgithub.com/TATDK/plugCubed/1.7.0-new/langs/lang."+
localStorage.Y+".js",$.proxy(this.xa,this)),"undefined"===typeof jQuery.fn.tabs&&($.getScript("http://code.jquery.com/ui/1.10.2/jquery-ui.js"),$("head").append('<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />')))},d:function(a,b){var c=this.lang,g;a=a.split(".");for(g in a){if(c[a[g]]===d)return"{"+a.join(".")+"}";c=c[a[g]]}if(b)for(g in b)c=c.split("%"+(~~g+1)).join(b[g]);return c},xa:function(){this.mb={};this.ma=h;this.colors={lb:"66FFFF",eb:"FF0000",
Ea:"FFFF00",cb:"66FFFF"};this.ha=this.d("AFK");setTimeout(function(){plugCubed.history={};var a=API.Da(),b;for(b in a){var c=a[b];plugCubed.history.push({id:c.media.id,author:c.media.author,title:c.media.title,aa:h,user:{id:c.user.id.toString(),username:c.user.username}})}},1);this.M=$('<style type="text/css"></css>');$("head").append(this.M);API.f(this.d("running",[this.version.toString()]));API.f(this.d("commandsHelp"));Dialog.kb=function(){throw new k;};socket.chat=function(){throw new k;};API.on(API.va,
this.ga);this.Ia();$("body").prepend('<link rel="stylesheet" type="text/css" id="plugcubed-css" href="https://rawgithub.com/TATDK/plugCubed/1.7.0-new/plugCubed.css" />');$("body").append('<div id="side-left" class="sidebar"><div class="sidebar-content"></div></div><div id="side-right" class="sidebar"><div class="sidebar-handle"><span>||</span></div><div class="sidebar-content"></div></div>').append('<script type="text/javascript" src="https://rawgithub.com/TATDK/plugCubed/1.7.0-new/thirdparty.js">\x3c/script>');
this.Ga();this.Fa();this.settings.userlist?(this.V(),this.Z()):this.ka();var a=API.getUsers(),b;for(b in a){var c=a[b];c.K===d&&(c.K=0);c.H===d&&(c.H=0);c.B===d&&(c.B=0);c.joinTime===d&&(c.joinTime=this.O())}SocketListener.chat=function(a){if("undefined"!==typeof plugCubed&&a.fromID&&-1<plugCubed.settings.F.indexOf(a.fromID))return plugCubed.fa(a);Models.chat.receive(a);API.delayDispatch(API.CHAT,a)};EXT||(EXT={});EXT.onRoomJoined?(EXT.ca||(EXT.ca=EXT.onRoomJoined),EXT.onRoomJoined=function(){"undefined"!==
typeof plugCubed&&(plugCubed.close(),plugCubed=new p);EXT.ca()}):EXT.onRoomJoined=function(){"undefined"!==typeof plugCubed&&(plugCubed.close(),plugCubed=new p)};this.ba()},close:function(){API.off(API.va,this.ga);API.off(API.DJ_ADVANCE,this.proxy.S);API.off(API.VOTE_UPDATE,this.proxy.onVoteUpdate);API.off(API.CURATE_UPDATE,this.proxy.R);API.off(API.USER_JOIN,this.proxy.T);API.off(API.USER_LEAVE,this.proxy.U);API.off(API.CHAT,this.proxy.Q);API.off(API.VOTE_SKIP,this.proxy.u);API.off(API.USER_SKIP,
this.proxy.u);API.off(API.MOD_SKIP,this.proxy.u);API.off(API.WAIT_LIST_UPDATE,this.proxy.k);for(var a in plugCubed.D)a===d||plugCubed.D[a]===d||($("#plugcubed-btn-"+a).unbind(),delete plugCubed.D[a]);$("#plugcubed-css").remove();$("#plugcubed-js-extra").remove();$("#side-right").remove();$("#side-left").remove();this.M.remove();this.z.onclose=function(){};this.z.close();delete plugCubed},ba:function(){this.z=new SockJS("http://socket.plugpony.net:923/gateway");this.z.J=0;this.z.onopen=function(){this.J=
0;var a=API.getSelf();this.send(JSON.stringify({type:"userdata",id:a.id,username:a.username,room:window.location.pathname.split("/")[1],version:plugCubed.version.toString()}))};this.z.onmessage=function(a){a=JSON.parse(a.data);"update"===a.type?(plugCubed.z.onclose=function(){},plugCubed.z.close(),API.f(plugCubed.d("newVersion"),f,plugCubed.colors.Ea),setTimeout(function(){$.getScript("https://rawgithub.com/TATDK/plugCubed/1.7.0-new/plugCubed."+(plugCubed.ma?"min.":"")+"js")},5E3)):"chat"===a.type&&
SocketListener.chat(a.data)};this.z.onclose=function(){this.J++;var a;if(5>this.J)a=5;else if(30>this.J)a=30;else if(60>this.J)a=60;else return;setTimeout(function(){plugCubed.ba()},1E3*a)}},Z:function(){$("#side-left").show().animate({left:"0px"},300,"undefined"===typeof jQuery.easing.Ba?d:"easeOutQuart")},ka:function(){var a=-$("#side-left").width()-20;$("#side-left").animate({left:a+"px"},300,"undefined"===typeof jQuery.easing.Ba?d:"easeOutQuart",function(){$("#side-left").hide()})},Ya:{you:{title:"ranks.you",
color:"FFDD6F"},regular:{title:"ranks.regular",color:"B0B0B0"},featureddj:{title:"ranks.featureddj",color:"E90E82"},bouncer:{title:"ranks.bouncer",color:"E90E82"},manager:{title:"ranks.manager",color:"E90E82"},cohost:{title:"ranks.cohost",color:"E90E82"},host:{title:"ranks.host",color:"E90E82"},ambassador:{title:"ranks.ambassador",color:"9A50FF"},admin:{title:"ranks.admin",color:"42A5DC"},join:{title:"notify.join",color:"3366FF"},leave:{title:"notify.leave",color:"3366FF"},curate:{title:"notify.curate",
color:"00FF00"},Qa:{title:"notify.stats",color:"66FFFF"},Sa:{title:"notify.updates",color:"FFFF00"}},settings:{recent:h,awaymsg:"",autowoot:h,autojoin:h,userlist:h,autorespond:h,menu:h,notify:h,customColors:h,N:e,Xa:e,q:[],F:[],da:[],A:h,W:{enabled:h,limit:50},colors:{you:"FFDD6F",regular:"B0B0B0",featureddj:"E90E82",bouncer:"E90E82",manager:"E90E82",cohost:"E90E82",host:"E90E82",ambassador:"9A50FF",admin:"42A5DC",join:"3366FF",leave:"3366FF",curate:"00FF00",Qa:"66FFFF",Sa:"FFFF00"},alerts:{join:h,
leave:h,curate:h,Pa:h,Oa:h}},Ia:function(){if(localStorage.na!==d){var a=JSON.parse(localStorage.na),b;for(b in this.settings)a[b]!==d&&(this.settings[b]=a[b]);this.settings.recent=h;this.settings.autowoot&&this.pa();this.settings.userlist&&(this.V(),this.Z());this.settings.customColors&&this.Ra();0<this.settings.q.length&&-1<this.settings.q.indexOf(Models.room.data.media.id)&&(API.setVolume(0),this.settings.A=e,API.f(this.d("automuted",[Models.room.data.media.title])))}},saveSettings:function(){localStorage.na=
JSON.stringify(this.settings)},Ra:function(){this.settings.customColors?this.M.text([".chat-message .chat-from,",".chat-mention .chat-from { color:#"+this.settings.colors.regular+"!important; }",".chat-message .chat-from-featureddj,",".chat-mention .chat-from-featureddj { color:#"+this.settings.colors.featureddj+"!important; }",".chat-message .chat-from-bouncer,",".chat-mention .chat-from-bouncer { color:#"+this.settings.colors.bouncer+"!important; }",".chat-message .chat-from-manager,",".chat-mention .chat-from-manager { color:#"+
this.settings.colors.manager+"!important; }",".chat-message .chat-from-cohost,",".chat-mention .chat-from-cohost { color:#"+this.settings.colors.cohost+"!important; }",".chat-message .chat-from-host,",".chat-mention .chat-from-host { color:#"+this.settings.colors.host+"!important; }",".chat-message .chat-from-ambassador,",".chat-mention .chat-from-ambassador { color:#"+this.settings.colors.ambassador+"!important; }",".chat-message .chat-from-admin,",".chat-mention .chat-from-admin { color:#"+this.settings.colors.admin+
"!important; }",".chat-message .chat-from-you,",".chat-mention .chat-from-you { color:#"+this.settings.colors.you+"!important; }"].join("\n")):this.M.text("")},Fa:function(){API.on(API.DJ_ADVANCE,this.proxy.S);API.on(API.VOTE_UPDATE,this.proxy.onVoteUpdate);API.on(API.CURATE_UPDATE,this.proxy.R);API.on(API.USER_JOIN,this.proxy.T);API.on(API.USER_LEAVE,this.proxy.U);API.on(API.CHAT,this.proxy.Q);API.on(API.VOTE_SKIP,this.proxy.u);API.on(API.USER_SKIP,this.proxy.u);API.on(API.MOD_SKIP,this.proxy.u);
API.on(API.WAIT_LIST_UPDATE,this.proxy.k)},Ga:function(){$("#side-right .sidebar-content").html("");this.j(this.settings.autowoot,"woot",this.d("menu.autowoot"));this.j(this.settings.autojoin,"join",this.d("menu.autojoin"));this.j(this.settings.userlist,"userlist",this.d("menu.userlist"));this.j(this.settings.customColors,"colors",this.d("menu.customchatcolors"));this.j(this.settings.autorespond,"autorespond",this.d("menu.afkstatus"));this.j(this.settings.notify,"notify",this.d("menu.notify"));this.j(this.settings.W.enabled,
"chatlimit",this.d("menu.limitchatlog"));this.j(!DB.settings.streamDisabled,"stream",this.d("menu.stream"));this.j(this.settings.N,"emoji",this.d("menu.emoji"))},j:function(a,b,c){this.D[b]===d&&(0<$("#side-right .sidebar-content").children().length&&$("#side-right .sidebar-content").append("<hr />"),$("#side-right .sidebar-content").append('<a id="plugcubed-btn-'+b+'"><div class="status-'+(a?"on":"off")+'"></div>'+c+"</a>"),$("#plugcubed-btn-"+b).data("key",b).click(this.proxy.menu),this.D[b]={text:c})},
i:function(a,b){$("#plugcubed-btn-"+a).find('[class^="status-"], [class*=" status-"]').attr("class","status-"+(b===e?"on":"off"))},V:function(){0<$("#side-left .sidebar-content").children().length&&$("#side-left .sidebar-content").append("<hr />");$("#side-left .sidebar-content").bind("contextmenu",function(){return h});$("#side-left .sidebar-content").html('<h1 class="users">Users: '+API.getUsers().length+"</h1>");var a=Models.room.getWaitListPosition(),a=$("<h3></h3>").addClass("waitlistspot").text("Waitlist: "+
(a!==f?a+" / ":"")+API.getWaitList().length);$("#side-left .sidebar-content").append(a).append("<hr />");var a=API.getUsers(),b;for(b in a)this.ya(a[b])},ya:function(a){var b,c=Utils.cleanTypedString(a.username);b=a.curated==e?"curate":this.C(a.id)?"plugcubed":this.la(a.id)?"vip":API.hasPermission(a.id,API.g.FEATUREDDJ)?"fdj":API.hasPermission(a.id,API.g.BOUNCER)?"bouncer":API.hasPermission(a.id,API.g.MANAGER)?"manager":API.hasPermission(a.id,API.g.COHOST)?"host":API.hasPermission(a.id,API.g.wa)?
"host":API.hasPermission(a.id,API.g.ta)?"ambassador":API.hasPermission(a.id,API.g.qa)?"admin":"normal";0<Models.room.data.djs.length&&Models.room.data.djs[0].user.id==a.id?this.ea("normal"===b?"void":b+"_current","#66FFFF",a.username):this.ea("normal"===b?"void":b+this.Ma(a.vote),this.za(a.vote),c)},za:function(a){var b="";if(a===d)b="FFFFFF";else switch(a){case -1:b="ED1C24";break;case 1:b="3FFF00";break;default:b="FFFFFF"}return"#"+b},Ma:function(a){var b="";if(a===d)b="undecided";else switch(a){case -1:b=
"meh";break;case 1:b="woot";break;default:b="undecided"}return"_"+b},ea:function(a,b,c){$("#side-left .sidebar-content").append($("<p></p>").append($("<span></span>").append($("<span></span>").addClass(a)).css("cursor","pointer").css("color",b).mousedown(function(a){switch(a.which){case 1:$("#chat-input-field").val($("#chat-input-field").val()+"@"+c+" ").focus();break;case 3:(API.hasPermission(d,API.g.BOUNCER)||plugCubed.C(Models.user.data.id))&&plugCubed.P(c)}}).html(function(a,b){return b+c})))},
getUser:function(a){a=a.trim();"@"===a.substr(0,1)&&(a=a.substr(1));var b=API.getUsers(),c;for(c in b)if(("string"!==typeof a?0:b[c].username.toLowerCase()===a.toLowerCase())||("string"!==typeof a?0:b[c].id.toLowerCase()===a.toLowerCase()))return b[c];return f},X:function(a,b){if(Models.room.data.staff[Models.user.data.id]&&Models.room.data.staff[Models.user.data.id]>=Models.user.BOUNCER){var c;switch(b){case "kick":c=moderateKickUser;break;case "removedj":c=moderateRemoveDJ;break;case "adddj":c=
moderateAddDJ;break;default:API.f(this.d("error.unknownModeration"));return}var g=this.getUser(a);if(g===f)API.f(this.d("error.userNotFound"));else API[c](g.id," ")}},P:function(a){a=this.getUser(a);if(a===f)API.f(this.d("error.userNotFound"));else{var b=API.$a(),c=-1,g=API.getDJs();API.hasPermission(a.id,API.g.FEATUREDDJ)?this.d("ranks.featureddj"):API.hasPermission(a.id,API.g.BOUNCER)?this.d("ranks.bouncer"):API.hasPermission(a.id,API.g.MANAGER)?this.d("ranks.manager"):API.hasPermission(a.id,API.g.COHOST)?
this.d("ranks.cohost"):API.hasPermission(a.id,API.g.wa)?this.d("ranks.host"):API.hasPermission(a.id,API.g.ta)?this.d("ranks.ambassador"):API.hasPermission(a.id,API.g.qa)?this.d("ranks.admin"):this.d("ranks.regular");if(0===b)if(0<g.length&&g[0].user.id===a.id)this.d("info.djing"),c=0;else{for(b=1;b<g.length;b++)c=g.user.id===a.id?b:c;0>c?this.d("info.notinlist"):this.d("info.inbooth",[c+1,g.length])}else this.d("info.inwaitlist",[b,API.getWaitList().length]);switch(a.status){default:this.d("status.available");
break;case API.L.ra:this.d("status.afk");break;case API.L.Va:this.d("status.working");break;case API.L.Ua:this.d("status.sleeping")}switch(a.vote){case -1:this.d("vote.meh");break;default:this.d("vote.undecided");break;case 1:this.d("vote.woot")}0===c&&this.d("vote.djing");this.C(a.id)&&this.d("info.specialTitles.developer");this.la(a.id)&&this.d("info.specialTitles.vip");throw new k;}},onMenuClick:function(a){a=$(a.currentTarget).data("key");switch(a){case "woot":this.settings.autowoot=!this.settings.autowoot;
this.i("woot",this.settings.autowoot);this.settings.autowoot&&$("#button-vote-positive").click();break;case "join":this.settings.autojoin=!this.settings.autojoin;this.i("join",this.settings.autojoin);this.settings.autojoin&&0<$("#button-dj-waitlist-join").length&&API.ia();break;case "userlist":this.settings.userlist=!this.settings.userlist;this.i("userlist",this.settings.userlist);this.settings.userlist?(this.V(),this.Z()):($("#side-left .sidebar-content").empty(),this.ka());break;case "colors":throw new k;
case "autorespond":this.settings.autorespond=!this.settings.autorespond;this.i("autorespond",this.settings.autorespond);if(this.settings.autorespond){a=prompt("Please enter your away message here.\nThis is what you will reply via @mention.",""===this.settings.awaymsg?this.ha:this.settings.awaymsg);if(a===f){this.settings.autorespond=h;this.i("autorespond",h);return}a=a.split("@").join("").trim();this.settings.awaymsg=""===a?this.ha:a;0>=API.getSelf().status&&API.I(API.L.ra)}else API.I(API.L.Ta);break;
case "notify":throw new k;case "chatlimit":throw new k;case "stream":return this.i("stream",DB.settings.streamDisabled),API.sendChat(DB.settings.streamDisabled?"/stream on":"/stream off");case "emoji":this.settings.N=!this.settings.N;this.i("emoji",this.settings.N);break;default:return API.f(this.d("menu.unknown"))}this.saveSettings()},jb:function(){throw new k;},fb:function(){throw new k;},hb:function(){for(var a in this.settings.colors){var b=$('input[name="'+a+'"]');b.val(b.data("ph"));b.parents(".dialog-input-container").find(".dialog-input-label").css("color",
"#"+b.val())}},ib:function(){throw new k;},onVoteUpdate:function(a){if(a&&a.user){var b=API.getUser(a.user.id);this.k();1===b.B?b.K--:-1===b.B&&b.H--;1===a.vote?b.K++:-1===a.vote&&b.H++;b.B=a.vote}},R:function(a){var b=API.getMedia();this.settings.notify===e&&this.settings.alerts.curate===e&&API.f(this.d("notify.message.curate",[a.user.username,b.author,b.title]));API.getUser(a.user.id).curated=e;this.k()},S:function(a){this.settings.notify===e&&(this.settings.alerts.Oa===e&&API.f(this.d("notify.message.stats",
[a.lastPlay.score.positive,a.lastPlay.score.negative,a.lastPlay.score.curates])),this.settings.alerts.Pa===e&&API.f(this.d("notify.message.updates",[a.media.title,a.media.author,a.dj.username])));setTimeout($.proxy(this.Ja,this),1E3*Math.Na());(2<=API.getSelf().permission||this.C(API.getSelf().id))&&this.Ka(a.media.id);this.history.unshift({id:a.media.id,author:a.media.author,title:a.media.title,aa:h,user:{id:a.dj.id,username:a.dj.username}});this.history.splice(50,this.history.length-50);this.settings.A&&
0>this.settings.q.indexOf(a.media.id)&&(setTimeout(function(){API.setVolume(plugCubed.lastVolume)},800),this.settings.A=h);!this.settings.A&&-1<this.settings.q.indexOf(a.media.id)&&(setTimeout(function(){API.setVolume(0)},800),this.settings.A=e,this.lastVolume=API.ja(),API.f(i18n("automuted",[a.media.title])));this.k();a=API.getUsers();for(var b in a)a[b].B=0},Ja:function(){this.settings.autowoot&&0>this.settings.q.indexOf(API.Da()[0].media.id)&&this.pa();this.settings.autojoin&&("block"===$("#button-dj-play").css("display")||
"block"===$("#button-dj-waitlist-join").css("display"))&&API.ia()},pa:function(){if(0!==API.getDJs().length){var a=API.getDJs()[0];a===f||a==API.getSelf()||$("#button-vote-positive").click()}},T:function(a){this.settings.notify===e&&this.settings.alerts.join===e&&API.f(Utils.cleanTypedString(a.username+" joined the room"));a=API.getUser(a.id);a.K===d&&(a.K=0);a.H===d&&(a.H=0);a.B===d&&(a.B=0);a.joinTime===d&&(a.joinTime=this.O());this.k()},U:function(a){this.settings.notify===e&&this.settings.alerts.leave===
e&&API.f(Utils.cleanTypedString(a.username+" left the room"));this.k()},C:function(a){return"50aeb31696fba52c3ca0adb6"==a||"50aeb077877b9217e2fbff00"==a},la:function(a){return"5112c273d6e4a94ec0554792"==a||"50b1961c96fba57db2230417"==a},fa:function(a){var b="mention"==a.type&&API.hasPermission(a.fromID,API.g.BOUNCER),c=0>a.message.indexOf("@")&&this.C(a.fromID);if(b||c)-1<a.message.indexOf("!disable")&&(this.settings.autojoin?(this.settings.autojoin=h,this.i("join",this.settings.autojoin),this.saveSettings(),
API.Aa(),API.sendChat("@"+a.from+" Autojoin disabled")):API.sendChat("@"+a.from+" Autojoin was not enabled")),-1<a.message.indexOf("!afkdisable")&&(this.settings.autorespond?(this.settings.autorespond=h,this.i("autorespond",this.settings.autorespond),this.saveSettings(),API.sendChat("@"+a.from+" AFK message disabled")):API.sendChat("@"+a.from+" AFK message was not enabled"))},Q:function(a){this.fa(a);if("mention"==a.type)this.settings.autorespond&&!this.settings.recent&&(this.settings.recent=e,setTimeout(function(){plugCubed.settings.recent=
h;plugCubed.saveSettings()},18E4),API.sendChat("@"+a.from+" "+this.settings.awaymsg));else for(var b in this.settings.da)-1<a.message.indexOf(this.settings.da[b])&&document.getElementById("chat-sound").playMentionSound();if(this.settings.W.enabled){a=$("#chat-messages").children("div");var c=a.length;b=0;a.each(function(){++b;var a=c-plugCubed.settings.W.limit-1;b<a?$(this).remove():b==a&&0==b%2&&$(this).remove()})}},k:function(){this.settings.userlist&&this.V()},u:function(){this.history[1].aa=e},
Ka:function(a){var b=-1,c;for(c in this.history){var g=this.history[c];if(g.id==a&&51>~~c+2&&(b=~~c+2,!g.aa))return Popout==f||Popout==d?(document.getElementById("chat-sound").playMentionSound(),setTimeout(function(){document.getElementById("chat-sound").playMentionSound()},100)):(Popout.document.getElementById("chat-sound").playMentionSound(),setTimeout(function(){Popout.document.getElementById("chat-sound").playMentionSound()},100)),API.f("Song is in history ("+b+" of "+this.history.length+")",
e)}if(0<b)return API.f("Song is in history ("+b+" of "+this.history.length+"), but was skipped on the last play",e)},O:function(){var a=new Date,b=a.getMinutes();return a.getHours()+":"+((10>b?"0":"")+b)},ga:function(a){if(this.Wa(a)===e)return("/stream on"==a||"/stream off"==a)&&plugCubed.i("stream",!DB.settings.streamDisabled),"/afk"==a&&plugCubed.settings.autojoin&&(plugCubed.settings.autojoin=h,plugCubed.i("join",h),plugCubed.saveSettings()),e;if(0===a.indexOf("/commands")){a=[["/nick","change username"],
["/avail","set status to available"],["/afk","set status to afk"],["/work","set status to working"],["/sleep","set status to sleeping"],["/join","join dj booth/waitlist"],["/leave","leaves dj booth/waitlist"],["/whoami","get your own information"],["/mute","set volume to 0"],["/automute","register currently playing song to automatically mute on future plays"],["/unmute","set volume to last volume"],["/woot","woots current song"],["/meh","mehs current song"],["/refresh","refresh the video"],["/ignore (username)",
"ignore all chat messages from user"],["/alertson (word)","play mention sound whenever word is written in chat"],["/curate","add current song to your selected playlist"],["/getpos","get current waitlist position"],["/version","displays version number"],["/commands","shows this list"],["/link","paste link to plugCubed website in chat"]];for(var b in a);if(API.hasPermission(API.g.BOUNCER)){a=[["/whois (username)","gives general information about user",API.g.BOUNCER],["/skip","skip current song",API.g.BOUNCER],
["/kick (username)","kicks targeted user",API.g.BOUNCER],["/lock","locks DJ booth",API.g.MANAGER],["/unlock","unlocks DJ booth",API.g.MANAGER],["/add (username)","adds targeted user to dj booth/waitlist",API.g.BOUNCER],["/remove (username)","removes targeted user from dj booth/waitlist",API.g.BOUNCER]];for(b in a)API.hasPermission(a[b][2]);throw new k;}return e}if("/avail"==a||"/available"==a)return API.I(0),e;if("/brb"==a||"/away"==a)return API.I(1),plugCubed.settings.autojoin&&(plugCubed.settings.autojoin=
h,plugCubed.i("join",h),plugCubed.saveSettings()),e;if("/work"==a||"/working"==a)return API.I(2),e;if("/sleep"==a||"/sleeping"==a)return API.I(3),plugCubed.settings.autojoin&&(plugCubed.settings.autojoin=h,plugCubed.i("join",h),plugCubed.saveSettings()),e;if("/join"==a)return API.ia(),e;if("/leave"==a)return API.Aa(),e;if("/whoami"==a)return plugCubed.P(Models.user.data.id),e;if("/woot"==a)return $("#button-vote-positive").click(),e;if("/meh"==a)return $("#button-vote-negative").click(),e;if("/refresh"==
a)return $("#button-refresh").click(),e;if("/version"==a)return API.f(this.d("running",[plugCubed.version.toString()])),e;if("/mute"==a)return plugCubed.lastVolume=API.ja(),API.setVolume(0),e;if("/link"==a)return API.sendChat("plugCubed : http://tatdk.github.io/plugCubed"),e;if("/unmute"==a)return API.setVolume(plugCubed.lastVolume),e;"/nextsong"==a&&(b=API.Za(),b===d?API.f(plugCubed.d("noNextSong")):b.bb?(API.f(plugCubed.d("nextsong",[b.title,b.author])),API.f(plugCubed.d("isHistory",[found,plugCubed.history.length]),
e)):API.f(plugCubed.d("nextsong",[b.title,b.author])));if("/automute"==a){b=API.getMedia();if(b===d)return e;0>plugCubed.settings.q.indexOf(b.id)?(plugCubed.settings.q.push(b.id),plugCubed.settings.A=e,plugCubed.lastVolume=API.ja(),API.setVolume(0),API.f(b.title+" registered to auto-mute on future plays.")):(plugCubed.settings.q.splice(plugCubed.settings.q.indexOf(API.getMedia().id),1),plugCubed.settings.A=h,API.setVolume(plugCubed.lastVolume),API.f(b.title+" removed from automute registry."));plugCubed.saveSettings();
return e}if("/alertsoff"==a)return plugCubed.settings.notify&&(API.f(plugCubed.d("notify.message.disabled")),plugCubed.settings.notify=h,plugCubed.i("notify",h)),e;if("/alertson"==a)return plugCubed.settings.notify||(API.f(plugCubed.d("notify.message.enabled")),plugCubed.settings.notify=e,plugCubed.i("notify",e)),e;if(0===a.indexOf("/getpos"))return a=plugCubed.getUser(a.substr(8)),a=a===f?API.getSelf():a,b=API.getWaitListPosition(a.id),b!==f?API.f(plugCubed.d("info.inwaitlist",[b,Models.room.data.waitList.length])):
(b=API.Ca(a.id),0>b?API.f(plugCubed.d("info.notinlist")):0===b?API.f(plugCubed.d("info.userDjing",[a.id===API.getSelf().id?plugCubed.d("you"):a.username])):1===b?API.f(plugCubed.d("info.userNextDJ",[a.id===API.getSelf().id?plugCubed.d("you"):a.username])):API.f(plugCubed.d("info.inbooth",[b+1,API.getDJs().length]))),e;if(0===a.indexOf("/ignore ")||0===a.indexOf("/unignore "))return a=plugCubed.getUser(a.substr(8)),a===f?(API.f(plugCubed.d("error.userNotFound")),e):a.id===API.getSelf().id?(API.f(plugCubed.d("error.ignoreSelf")),
e):-1<plugCubed.settings.F.indexOf(a.id)?(plugCubed.settings.F.splice(plugCubed.settings.F.indexOf(a.id),1),plugCubed.saveSettings(),API.f(plugCubed.d("ignore.disabled",[a.username])),e):(plugCubed.settings.F.push(a.id),plugCubed.saveSettings(),API.f(plugCubed.d("ignore.enabled",[a.username])),e);if(plugCubed.C(Models.user.data.id)&&0===a.indexOf("/whois "))return plugCubed.P(a.substr(7)),e;if(Models.user.hasPermission(Models.user.BOUNCER)){if(0===a.indexOf("/skip")){if(1>API.getDJs().length)return;
if(0===API.Ca())Room.onSkipClick();else b=a.substr(5).trim(),a=plugCubed.getUser(API.getDJs()[0]),b&&API.sendChat((a!=f?"@"+a.username+" - ":"")+"Reason for skip: "+b),API.moderateForceSkip();return e}if(0===a.indexOf("/whois "))return plugCubed.P(a.substr(7)),e;if(0===a.indexOf("/kick "))return 0<a.indexOf("::")?(b=a.substr(6).split(":: "),a=plugCubed.getUser(b[0]),API.moderateKickUser(a.id,b[1]),e):(plugCubed.X(a.substr(6),"kick"),e);if(0===a.indexOf("/add "))return plugCubed.X(a.substr(5),"adddj"),
e;if(0===a.indexOf("/remove "))return plugCubed.X(a.substr(8),"removedj"),e}if(Models.user.hasPermission(Models.user.MANAGER)){if("/lock"===a)return new RoomPropsService(document.location.href.split("/")[3],e,Models.room.data.waitListEnabled,Models.room.data.maxPlays,Models.room.data.maxDJs),e;if("/unlock"===a)return new RoomPropsService(document.location.href.split("/")[3],h,Models.room.data.waitListEnabled,Models.room.data.maxPlays,Models.room.data.maxDJs),e}return h}});
if(localStorage.Y===d){var plugCubed=f;new (Class.extend({init:function(){$("#overlay-container").append($("#avatar-overlay").clone(h,h).attr("id","plugCubedLang-overlay").width(800).height(600).css("position","absolute"));$("#plugCubedLang-overlay").find(".overlay-title").html("plug&#179; language");$("#plugCubedLang-overlay").find("#avatar-sets").remove();$("#plugCubedLang-overlay").find("#avatar-panel").attr("id","plugCubedLang-panel").css("padding-top","60px");$("#plugCubedLang-overlay").find(".overlay-close-button").click($.proxy(this.hide,
this));this.Ha()},show:function(){UserListOverlay.hide();$("#lobby-overlay").hide();$("#media-overlay").hide();$("#avatar-overlay").hide();$("#plugCubedLang-overlay").show();$("#overlay-container").show();this.draw()},hide:function(){UserListOverlay.hide();$("#lobby-overlay").hide();$("#media-overlay").hide();$("#avatar-overlay").hide();$("#plugCubedLang-overlay").hide();$("#overlay-container").hide()},draw:function(){$("#plugCubedLang-panel").html("").scrollTop(0);var a=this.G.length,b=$("<div/>");
if(5<a)for(var c=0;c<a/5;c++)b.append(this.drawRow(this.G.slice(5*c,5*c+5)).css("top",75*c));else b.append(this.drawRow(this.G).css("top",75*c));$("#plugCubedLang-panel").append(b);$(".lang-button").click($.proxy(this.La,this))},drawRow:function(a){for(var b=$("<div/>").addClass("lang-row"),c=a.length,g=5==c?0:4==c?75:3==c?150:2==c?225:300,l=0;l<c;++l){var q=$("<div/>").addClass("lang-button").css("display","inline-block").css("left",g).data("language",a[l].file).css("cursor","pointer").append($("<img/>").attr("src",
"https://rawgithub.com/TATDK/plugCubed/1.7.0-new/flags/flag."+a[l].file+".png").attr("alt",a[l].name).height(75).width(150));b.append(q);g+=150}return b},La:function(a){a=$(a.currentTarget);localStorage.Y=a.data("language");plugCubed=new p;this.hide()},Ha:function(){var a=this;this.G=[];$.getJSON("https://rawgithub.com/TATDK/plugCubed/1.7.0-new/lang.txt",function(b){a.G=b;a.show()}).done(function(){0===a.G.length&&log('<span style="color:#FF0000">Error loading plugCubed</span>')})}}))}else plugCubed=
new p;plugCubed.ma=e;
//# sourceMappingURL=https://rawgithub.com/TATDK/plugCubed/1.7.0/plugCubed.min.js.map 
